fix (f : tree -> bool) =
    fun (x : tree) ->
        match x with
        | Leaf _ -> True
        | Node (v,l,r) -> match compare (height l) (height r) with
                          | EQ _ -> band (f r) (f l) 
                          | LT _ -> (match compare S((height l)) (height r) with
                                    | LT _ -> False
                                    | _ -> band (f r) (f l) )
                          | GT _ -> (match compare S((height r)) (height l) with
                                    | LT _ -> False
                                    | _ -> band (f r) (f l) )